{
	"name": "dataflow2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DivoriceContainerSrc",
						"type": "DatasetReference"
					},
					"name": "DivorceSource"
				},
				{
					"dataset": {
						"referenceName": "DestinationDataset_xuq",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Outputfiles",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "LastEventByCase"
				},
				{
					"name": "Join1"
				}
			],
			"script": "source(output(\n\t\textraction_date as string,\n\t\tcase_metadata_event_id as string,\n\t\tce_case_data_id as string,\n\t\tce_created_date as string,\n\t\tce_case_type_id as string,\n\t\tce_case_type_version as string,\n\t\tce_state_id as string,\n\t\tce_data as (D8Cohort as string, createdDate as string, D8DivorceWho as string, D8Connections as (A as string, C as string), D8DivorceUnit as string, D8MarriageDate as string, D8caseReference as string, D8FinancialOrder as string, D8PetitionerEmail as string, D8DivorceClaimFrom as string[], D8LegalProceedings as string, D8ReasonForDivorce as string, D8ScreenHasPrinter as string, D8StatementOfTruth as string, D8DivorceCostsClaim as string, D8FinancialOrderFor as string[], D8MarriageCanDivorce as string, D8PetitionerLastName as string, D8RespondentLastName as string, D8PetitionerFirstName as string, D8RespondentFirstName as string, D8HelpWithFeesNeedHelp as string, D8PetitionerHomeAddress as (PostCode as string), D8PetitionerPhoneNumber as string, D8RespondentHomeAddress as (PostCode as string), D8ScreenHasMarriageCert as string, D8DerivedStatementOfCase as string, D8JurisdictionConnection as string[], D8MarriagePetitionerName as string, D8MarriageRespondentName as string, D8LegalProceedingsDetails as string, D8LegalProceedingsRelated as string[], D8MarriageIsSameSexCouple as string, D8ScreenHasMarriageBroken as string, D8InferredPetitionerGender as string, D8InferredRespondentGender as string, D8PetitionerNameChangedHow as string[], D8ClaimsCostsAppliedForFees as string, D8HelpWithFeesAppliedForFees as string, D8JurisdictionConfidentLegal as string, D8ScreenHasRespondentAddress as string, D8HelpWithFeesReferenceNumber as string, D8ReasonForDivorceHasMarriage as string, D8DerivedPetitionerHomeAddress as string, D8DerivedRespondentCurrentName as string, D8DerivedRespondentHomeAddress as string, D8ReasonForDivorceLimitReasons as string, D8ReasonForDivorceShowAdultery as string, D8RespondentLivesAtLastAddress as string, D8ReasonForDivorceShowDesertion as string, D8DerivedRespondentSolicitorAddr as string, D8LivingArrangementsLiveTogether as string, D8ReasonForDivorceEnableAdultery as string, D8JurisdictionPetitionerResidence as string, D8JurisdictionRespondentResidence as string, D8PetitionerCorrespondenceAddress as (PostCode as string), D8ReasonForDivorceAdulteryIsNamed as string, D8RespondentCorrespondenceAddress as (PostCode as string), D8DerivedPetitionerCurrentFullName as string, D8ReasonForDivorceBehaviourDetails as string, D8ReasonForDivorceClaimingAdultery as string, D8DerivedRespondentSolicitorDetails as string, D8DerivedPetitionerCorrespondenceAddr as string, D8DerivedRespondentCorrespondenceAddr as string, D8LivingArrangementsLastLivedTogether as string, D8PetitionerContactDetailsConfidential as string, D8PetitionerNameDifferentToMarriageCert as string, D8DerivedLivingArrangementsLastLivedAddr as string, D8PetitionerCorrespondenceUseHomeAddress as string, D8ReasonForDivorceClaiming5YearSeparatio as string, D8ReasonForDivorceShowFiveYearsSeparatio as string, D8ReasonForDivorceShowTwoYearsSeparation as string, D8ReasonForDivorceShowUnreasonableBehavi as string, D8RespondentCorrespondenceUseHomeAddress as string, CoRespLetterHolderId as string, Payments as (id as string, value as (PaymentDate as string, PaymentFeeId as string, PaymentAmount as string, PaymentSiteId as string, PaymentStatus as string, PaymentChannel as string, PaymentReference as string, PaymentTransactionId as string))[], RespondentContactDetailsConfidential as string, CoRespEmailAddress as string, CoRespLinkedToCase as string, CoRespLinkedToCaseDate as string)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> source1\nsource(output(\n\t\textraction_date as string,\n\t\tcase_metadata_event_id as integer,\n\t\tce_case_data_id as integer,\n\t\tce_created_date as integer,\n\t\tce_case_type_id as string,\n\t\tce_case_type_version as integer,\n\t\tce_state_id as string,\n\t\tce_data as string,\n\t\tcd_checklist as string,\n\t\tcd_appealType as string,\n\t\tcd_newMatters as string,\n\t\tcd_legalRepName as string,\n\t\tcd_hasNewMatters as string,\n\t\tcd_appellantTitle as string,\n\t\tcd_hasOtherAppeals as string,\n\t\tcd_legalRepCompany as string,\n\t\tcd_appellantFamilyName as string,\n\t\tcd_appellantGivenNames as string,\n\t\tcd_appellantDateOfBirth as string,\n\t\tcd_appealReferenceNumber as string,\n\t\tcd_appellantNationalities as string,\n\t\tcd_homeOfficeDecisionDate as string,\n\t\tcd_appealGroundsForDisplay as string,\n\t\tcd_appealGroundsProtection as string,\n\t\tcd_appellantNameForDisplay as string,\n\t\tcd_legalRepReferenceNumber as string,\n\t\tcd_appealGroundsHumanRights as string,\n\t\tcd_appellantHasFixedAddress as string,\n\t\tcd_homeOfficeReferenceNumber as string,\n\t\tcd_sendDirectionActionAvailable as string,\n\t\tcd_currentCaseStateVisibleToCaseOfficer as string,\n\t\tcd_changeDirectionDueDateActionAvailable as string,\n\t\tcd_currentCaseStateVisibleToAdminOfficer as string,\n\t\tcd_uploadAddendumEvidenceActionAvailable as string,\n\t\tcd_currentCaseStateVisibleToHomeOfficeAll as string,\n\t\tcd_currentCaseStateVisibleToHomeOfficeApc as string,\n\t\tcd_currentCaseStateVisibleToHomeOfficePou as string,\n\t\tcd_currentCaseStateVisibleToHomeOfficeLart as string,\n\t\tcd_uploadAdditionalEvidenceActionAvailable as string,\n\t\tcd_currentCaseStateVisibleToHomeOfficeGeneric as string,\n\t\tcd_haveHearingAttendeesAndDurationBeenRecorded as string,\n\t\tcd_currentCaseStateVisibleToLegalRepresentative as string,\n\t\tcd_uploadAddendumEvidenceLegalRepActionAvailable as string,\n\t\tcd_uploadAddendumEvidenceHomeOfficeActionAvailable as string,\n\t\tcd_uploadAdditionalEvidenceHomeOfficeActionAvailable as string,\n\t\tcd_hearingCentre as string,\n\t\tcd_notificationsSent as string,\n\t\tcd_legalRepDeclaration as string,\n\t\tcd_submissionOutOfTime as string,\n\t\tcd_appealSubmissionDate as string,\n\t\tcd_legalRepresentativeName as string,\n\t\tcd_legalRepresentativeDocuments as string,\n\t\tcd_legalRepresentativeEmailAddress as string,\n\t\tcd_directions as string,\n\t\tcd_uploadHomeOfficeBundleAvailable as string,\n\t\tcd_respondentDocuments as string,\n\t\tcd_uploadedHomeOfficeBundleDocs as string,\n\t\tcd_caseBuildingReadyForSubmission as string,\n\t\tcd_caseArgumentDocument as string,\n\t\tcd_caseArgumentEvidence as string,\n\t\tcd_caseArgumentAvailable as string,\n\t\tcd_caseArgumentDescription as string,\n\t\tcd_respondentReviewAppealResponseAdded as string,\n\t\tcd_uploadHomeOfficeAppealResponseActionAvailable as string,\n\t\tcd_appealResponseAvailable as string,\n\t\tcd_amendResponseActionAvailable as string,\n\t\tcd_reviewResponseActionAvailable as string,\n\t\tcd_uploadedHomeOfficeAppealResponseDocs as string,\n\t\tcd_hearingDocuments as string,\n\t\tcd_listCaseHearingDate as string,\n\t\tcd_ariaListingReference as string,\n\t\tcd_listCaseHearingCentre as string,\n\t\tcd_listCaseHearingLength as string,\n\t\tcd_caseSummaryDocument as string,\n\t\tcd_caseSummaryDescription as string,\n\t\tcd_scheduleOfIssuesAgreement as string,\n\t\tcd_caseIntroductionDescription as string,\n\t\tcd_decisionAndReasonsAvailable as string,\n\t\tcd_immigrationHistoryAgreement as string,\n\t\tcd_appellantCaseSummaryDescription as string,\n\t\tcd_agreedImmigrationHistoryDescription as string,\n\t\tcd_appellantsAgreedScheduleOfIssuesDescription as string,\n\t\tcd_addendumEvidenceDocuments as string,\n\t\tcd_appealGroundsRevocation as string,\n\t\tcd_journeyType as string,\n\t\tcd_appellantAddress as string,\n\t\tcd_subscriptions as string,\n\t\tcd_anonymityOrder as string,\n\t\tcd_appellantRepresentative as string,\n\t\tcd_respondentRepresentative as string,\n\t\tcd_draftDecisionAndReasonsDocuments as string,\n\t\tcd_appealDate as string,\n\t\tcd_appealDecision as string,\n\t\tcd_isDecisionAllowed as string,\n\t\tcd_isDocumentSignedToday as string,\n\t\tcd_finalDecisionAndReasonsPdf as string,\n\t\tcd_isFeeConsistentWithDecision as string,\n\t\tcd_decisionAndReasonsCoverLetter as string,\n\t\tcd_finalDecisionAndReasonsDocuments as string,\n\t\tcd_reviewHomeOfficeResponseByLegalRep as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: false) ~> source2\nsource1 aggregate(groupBy(ce_case_data_id = ce_case_data_id),\n\tce_created_date = greatest(ce_created_date)) ~> LastEventByCase\nsource1, LastEventByCase join(case_metadata_event_id == LastEventByCase@ce_case_data_id,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nJoin1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}